<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Untitled Document</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../../styles/tablas.css" rel="stylesheet" type="text/css">
<link href="../../styles/pages.css" rel="stylesheet" type="text/css">
</head>

<body>
<table width="100%"  height="100%" border="0" cellspacing="0" cellpadding="0" align="center">
<tr>
<td align="center" valign="middle"><p class="title">Impresion de Listado de Efectivos </p>
  <form action="" method="post" name="form">
  <input name="temp" type="hidden">
  <table class="tabla">
    <tr>
      <th class="vtabla">        Compa&ntilde;&iacute;a</th>
      <td class="vtabla"><input name="cia0" type="text" class="insert" id="cia0" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia1,null,cia1,null,cia10)" size="3">
        <input name="cia1" type="text" class="insert" id="cia1" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia2,cia0,cia2,null,cia11)" size="3">
        <input name="cia2" type="text" class="insert" id="cia2" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia3,cia1,cia3,null,cia12)" size="3">
        <input name="cia3" type="text" class="insert" id="cia3" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia4,cia2,cia4,null,cia13)" size="3">
        <input name="cia4" type="text" class="insert" id="cia4" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia5,cia3,cia5,null,cia14)" size="3">
        <input name="cia5" type="text" class="insert" id="cia5" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia6,cia4,cia6,null,cia15)" size="3">
        <input name="cia6" type="text" class="insert" id="cia6" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia7,cia5,cia7,null,cia16)" size="3">
        <input name="cia7" type="text" class="insert" id="cia7" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia8,cia6,cia8,null,cia17)" size="3">
        <input name="cia8" type="text" class="insert" id="cia8" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia9,cia7,cia9,null,cia18)" size="3">
        <input name="cia9" type="text" class="insert" id="cia9" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia10,cia8,null,null,cia19)" size="3">
        <br>
        <input name="cia10" type="text" class="insert" id="cia10" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia11,null,cia1,cia0,cia20)" size="3">
        <input name="cia11" type="text" class="insert" id="cia11" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia12,cia10,cia2,cia1,cia21)" size="3">
        <input name="cia12" type="text" class="insert" id="cia12" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia13,cia11,cia3,cia2,cia22)" size="3">
        <input name="cia13" type="text" class="insert" id="cia13" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia14,cia12,cia4,cia3,cia23)" size="3">
        <input name="cia14" type="text" class="insert" id="cia14" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia15,cia13,cia5,cia4,cia24)" size="3">
        <input name="cia15" type="text" class="insert" id="cia15" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia16,cia14,cia6,cia5,cia25)" size="3">
        <input name="cia16" type="text" class="insert" id="cia16" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia17,cia15,cia7,cia6,cia26)" size="3">
        <input name="cia17" type="text" class="insert" id="cia17" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia18,cia16,cia8,cia7,cia27)" size="3">
        <input name="cia18" type="text" class="insert" id="cia18" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia19,cia17,cia9,cia8,cia28)" size="3">
        <input name="cia19" type="text" class="insert" id="cia19" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia20,cia18,null,cia9,cia29)" size="3">
        <br>
        <input name="cia20" type="text" class="insert" id="cia20" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia21,null,cia21,cia10,a_partir)" size="3">
        <input name="cia21" type="text" class="insert" id="cia21" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia22,cia20,cia22,cia11,a_partir)" size="3">
        <input name="cia22" type="text" class="insert" id="cia22" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia23,cia21,cia23,cia12,a_partir)" size="3">
        <input name="cia23" type="text" class="insert" id="cia23" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia24,cia22,cia24,cia13,a_partir)" size="3">
        <input name="cia24" type="text" class="insert" id="cia24" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia25,cia23,cia25,cia14,a_partir)" size="3">
        <input name="cia25" type="text" class="insert" id="cia25" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia26,cia24,cia26,cia15,a_partir)" size="3">
        <input name="cia26" type="text" class="insert" id="cia26" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia27,cia25,cia27,cia16,a_partir)" size="3">
        <input name="cia27" type="text" class="insert" id="cia27" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia28,cia26,cia28,cia17,a_partir)" size="3">
        <input name="cia28" type="text" class="insert" id="cia28" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,cia29,cia27,cia29,cia18,a_partir)" size="3">
        <input name="cia29" type="text" class="insert" id="cia29" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,a_partir,cia28,null,cia19,a_partir)" size="3">      </td>
    </tr>
    <tr>
      <th class="vtabla">A partir de </th>
      <td class="vtabla"><input name="a_partir" type="text" class="insert" id="a_partir" onFocus="temp.value=this.value;this.select()" onChange="isInt(this,temp)" onKeyDown="movCursor(event.keyCode,fecha,null,null,cia29,fecha)" size="3"></td>
    </tr>
    <!-- START BLOCK : bloque_admin -->
	<tr>
      <th class="vtabla">Administrador</th>
      <td class="vtabla"><select name="idadmin" class="insert" id="idadmin">
        <option value="" selected></option>
		<!-- START BLOCK : admin -->
        <option value="{id}">{nombre}</option>
		<!-- END BLOCK : admin -->
      </select></td>
    </tr>
	<!-- END BLOCK : bloque_admin -->
    <tr>
      <th class="vtabla">Fecha</th><td class="vtabla"><input name="fecha" type="text" class="insert" id="fecha" onChange="actualiza_fecha(this)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 37 || event.keyCode == 38 || event.keyCode == 39 || event.keyCode == 40) form.cia0.select();" value="{fecha}" size="10" maxlength="10"></td>
    </tr>
    <tr>
      <th class="vtabla">Tipo de listado</th>
      <td class="vtabla"><input name="tipo" type="radio" value="totales" checked>
        Totales
		<!-- START BLOCK : options -->
		<br>
        <input name="tipo" type="radio" value="reducidos"{disabled}>
        Reporte normal (Configurar impresora en apaisado) <br>
		<input name="tipo" type="radio" value="admin"{disabled}>
        Reporte administradores (Configurar impresora en apaisado) <br>
        <input type="radio" name="tipo" id="radio" value="mini"{disabled}>
         Reporte miniatura (Configurar impresora en apaisado)
		<!-- END BLOCK : options -->
        <!-- START BLOCK : bloque_opc -->
		<br>
		<input name="tipo" type="radio" value="completos"{disabled}>
        Reporte completo<br>
        <input name="tipo" type="radio" value="comparativo"{disabled}>
        Comparativo de Fin de Mes
		<!-- END BLOCK : bloque_opc -->
		<!-- START BLOCK : only_admin -->
		<br>
		<input name="tipo" type="radio" value="admin"{disabled}>
        Reporte administradores (Configurar impresora en apaisado)
		<!-- START BLOCK : only_admin -->
		</td>
    </tr>
  </table>
  <br>
  <!-- START BLOCK : bloque_cias -->
  <table class="tabla">
  <tr>
    <th colspan="10" class="tabla" scope="col">Compa&ntilde;&iacute;as que no se tomara en cuenta sus dep&oacute;sitos</th>
    </tr>
  <tr>
    <td class="tabla"><input name="num_cia0" type="text" class="insert" id="num_cia0" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia1.select();
else if (event.keyCode == 37) form.num_cia9.select();" size="3" maxlength="3"></td>
    <td class="tabla"><input name="num_cia1" type="text" class="insert" id="num_cia1" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia2.select();
else if (event.keyCode == 37) form.num_cia0.select();" size="3" maxlength="3"></td>
    <td class="tabla"><input name="num_cia2" type="text" class="insert" id="num_cia2" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia3.select();
else if (event.keyCode == 37) form.num_cia1.select();" size="3" maxlength="3"></td>
    <td class="tabla"><input name="num_cia3" type="text" class="insert" id="num_cia3" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia4.select();
else if (event.keyCode == 37) form.num_cia2.select();" size="3" maxlength="3"></td>
    <td class="tabla"><input name="num_cia4" type="text" class="insert" id="num_cia4" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia5.select();
else if (event.keyCode == 37) form.num_cia3.select();" size="3" maxlength="3"></td>
    <td class="tabla"><input name="num_cia5" type="text" class="insert" id="num_cia5" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia6.select();
else if (event.keyCode == 37) form.num_cia4.select();" size="3" maxlength="3"></td>
    <td class="tabla"><input name="num_cia6" type="text" class="insert" id="num_cia6" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia7.select();
else if (event.keyCode == 37) form.num_cia5.select();" size="3" maxlength="3"></td>
    <td class="tabla"><input name="num_cia7" type="text" class="insert" id="num_cia7" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia8.select();
else if (event.keyCode == 37) form.num_cia6.select();" size="3" maxlength="3"></td>
    <td class="tabla"><input name="num_cia8" type="text" class="insert" id="num_cia8" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia9.select();
else if (event.keyCode == 37) form.num_cia7.select();" size="3" maxlength="3"></td>
    <td class="tabla"><input name="num_cia9" type="text" class="insert" id="num_cia9" onFocus="for.temp.value=this.value" onChange="isInt(this,form.temp)" onKeyDown="if (event.keyCode == 13 || event.keyCode == 39) form.num_cia0.select();
else if (event.keyCode == 37) form.num_cia8.select();" size="3" maxlength="3"></td>
  </tr>
</table>
<!-- END BLOCK : bloque_cias -->
  <p>
    <input type="button" class="boton" value="Siguiente" onClick="listado(form)">
  </p></form></td>
</tr>
</table>
<script language="javascript">
	var f = document.form;
	
	function movCursor(keyCode, enter, lt, rt, up, dn) {
		if (keyCode == 13 && enter && enter != null) enter.focus();
		else if (keyCode == 37 && lt && lt != null) lt.focus();
		else if (keyCode == 39 && rt && rt != null) rt.focus();
		else if (keyCode == 38 && up && up != null) up.focus();
		else if (keyCode == 40 && dn && dn != null) dn.focus();
	}
	
	function listado(form) {
		var tipo = null;
		
		if (form.tipo.length == undefined) {
			tipo = form.tipo.value;
		}
		else {
			for (var i = 0; i < form.tipo.length; i++) {
				if (form.tipo[i].checked) {
					tipo = form.tipo[i].value;
				}
			}
		}
		
		if (form.fecha.value.length < 8) {
			alert("Debe especificar la fecha");
			form.fecha.select();
			return false;
		}
		else
			if (tipo == 'totales') {
				window.open("","lis_efe_tot","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,width=1024,height=768");
				form.target = "lis_efe_tot";
				form.action = "ban_efe_tot.php";
				form.submit();
			}
			else if (tipo == 'reducidos') {
				window.open("","lis_efe_red","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,width=1024,height=768");
				form.target = "lis_efe_red";
				form.action = "EfectivosReporteMensual.php?accion=reporteNormal";
				form.submit();
			}
			else if (tipo == 'admin') {
				window.open("","lis_efe_adm","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,width=1024,height=768");
				form.target = "lis_efe_adm";
				form.action = "EfectivosReporteMensual.php?accion=reporteAdministrador";
				form.submit();
			}
			else if (tipo == 'mini') {
				window.open("","lis_efe_mini","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,width=1024,height=768");
				form.target = "lis_efe_mini";
				form.action = "ban_efe_mini.php";
				form.submit();
			}
			else if (tipo == 'completos') {
				window.open("","lis_efe","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,width=1024,height=768");
				form.target = "lis_efe";
				form.action = "ban_efe_com_v2.php";
				form.submit();
			}
			else if (tipo == 'comparativo') {
				window.open("","lis_com","toolbar=no,location=no,directories=no,status=no,menubar=yes,scrollbars=yes,resizable=yes,width=1024,height=768");
				form.target = "lis_com";
				form.action = "ban_com_mes.php";
				form.submit();
			}
			
			var fecha = form.fecha.value;
			
			form.reset();
			
			form.fecha.value = fecha;
	}
	
	window.onload = document.form.cia0.select();
</script>
</body>
</html>
